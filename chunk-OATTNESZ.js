import{a as s,b as r,ha as g,m as n}from"./chunk-PHL42RAN.js";var b=(()=>{class d{storageKeys={categories:"hogar360_categories",ubicaciones:"hogar360_ubicaciones",properties:"hogar360_properties",usuarios:"hogar360_usuarios",visitSchedules:"hogar360_visit_schedules",visits:"hogar360_visits"};categoriesSubject=new n(this.getCategories());ubicacionesSubject=new n(this.getUbicaciones());propertiesSubject=new n(this.getProperties());usuariosSubject=new n(this.getUsuarios());visitSchedulesSubject=new n(this.getVisitSchedules());visitsSubject=new n(this.getVisits());constructor(){this.initializeDefaultData()}categories$=this.categoriesSubject.asObservable();ubicaciones$=this.ubicacionesSubject.asObservable();properties$=this.propertiesSubject.asObservable();usuarios$=this.usuariosSubject.asObservable();visitSchedules$=this.visitSchedulesSubject.asObservable();visits$=this.visitsSubject.asObservable();getCategories(){return this.getFromStorage(this.storageKeys.categories)||[]}saveCategories(e){this.saveToStorage(this.storageKeys.categories,e),this.categoriesSubject.next(e)}addCategory(e){let t=this.getCategories(),i=r(s({},e),{id:Date.now(),fechaCreacion:new Date().toISOString(),activo:!0});return t.push(i),this.saveCategories(t),i}updateCategory(e,t){let i=this.getCategories(),a=i.findIndex(o=>o.id===e);if(a!==-1){let o=r(s(s({},i[a]),t),{id:i[a].id,fechaActualizacion:new Date});return i[a]=o,this.saveCategories(i),o}throw new Error("Categor\xEDa no encontrada")}deleteCategory(e){let t=this.getCategories(),i=t.findIndex(a=>a.id===e);i!==-1&&(t[i]=r(s({},t[i]),{activo:!1}),this.saveCategories(t))}getCategoryById(e){return this.getCategories().find(i=>i.id===e)||null}getUbicaciones(){return this.getFromStorage(this.storageKeys.ubicaciones)||[]}saveUbicaciones(e){this.saveToStorage(this.storageKeys.ubicaciones,e),this.ubicacionesSubject.next(e)}addUbicacion(e){let t=this.getUbicaciones(),i=r(s({},e),{id:Date.now(),fechaCreacion:new Date,activo:!0});return t.push(i),this.saveUbicaciones(t),i}updateUbicacion(e,t){let i=this.getUbicaciones(),a=i.findIndex(o=>o.id===e);if(a!==-1){let o=r(s(s({},i[a]),t),{id:i[a].id,fechaActualizacion:new Date});return i[a]=o,this.saveUbicaciones(i),o}throw new Error("Ubicaci\xF3n no encontrada")}deleteUbicacion(e){let t=this.getUbicaciones(),i=t.findIndex(a=>a.id===e);i!==-1&&(t[i]=r(s({},t[i]),{activo:!1}),this.saveUbicaciones(t))}getUbicacionById(e){return this.getUbicaciones().find(i=>i.id===e)||null}getProperties(){return this.getFromStorage(this.storageKeys.properties)||[]}getPropertyById(e){return this.getProperties().find(i=>i.id===e)}saveProperties(e){this.saveToStorage(this.storageKeys.properties,e),this.propertiesSubject.next(e)}addProperty(e){let t=this.getProperties(),i=this.getCategories(),a=this.getUbicaciones(),o=i.find(u=>Number(u.id)===Number(e.categoria_id));if(!o)throw new Error("Categor\xEDa no encontrada");let c=a.find(u=>Number(u.id)===Number(e.ubicacion_id));if(!c)throw new Error("Ubicaci\xF3n no encontrada");let h={id:Date.now(),nombre:e.nombre,descripcion:e.descripcion,categoria:{id:o.id,nombre:o.nombre,descripcion:o.descripcion,activo:o.activo,fechaCreacion:o.fechaCreacion},cantidad_cuartos:e.cantidad_cuartos,cantidad_banos:e.cantidad_banos,precio:e.precio,ubicacion:{id:c.id,ciudad:c.ciudad,departamento:c.departamento,descripcionCiudad:c.descripcionCiudad,descripcionDepartamento:c.descripcionDepartamento,fechaCreacion:c.fechaCreacion,activo:c.activo},fecha_publicacion_activa:new Date(e.fecha_publicacion_activa),estado_publicacion:e.estado_publicacion,fecha_publicacion:new Date,vendedor:{id:1,nombre:"Usuario Actual"},created_at:new Date,updated_at:new Date,fechaCreacion:new Date,activo:!0};return t.push(h),this.saveProperties(t),this.propertiesSubject.next(t),h}updateProperty(e,t){let i=this.getProperties(),a=i.findIndex(o=>o.id===e);if(a!==-1){let o=r(s(s({},i[a]),t),{id:i[a].id,fechaActualizacion:new Date});return i[a]=o,this.saveProperties(i),o}throw new Error("Propiedad no encontrada")}deleteProperty(e){let i=this.getProperties().filter(a=>a.id!==e);this.saveProperties(i)}getUsuarios(){return this.getFromStorage(this.storageKeys.usuarios)||[]}saveUsuarios(e){this.saveToStorage(this.storageKeys.usuarios,e),this.usuariosSubject.next(e)}addUsuario(e){let t=this.getUsuarios();t.push(e),this.saveUsuarios(t)}updateUsuario(e){let t=this.getUsuarios(),i=t.findIndex(a=>a.id===e.id);i!==-1&&(t[i]=e,this.saveUsuarios(t))}deleteUsuario(e){let i=this.getUsuarios().filter(a=>a.id!==e);this.saveUsuarios(i)}getVisitSchedules(){return this.getFromStorage(this.storageKeys.visitSchedules)||[]}saveVisitSchedules(e){this.saveToStorage(this.storageKeys.visitSchedules,e),this.visitSchedulesSubject.next(e)}addVisitSchedule(e){let t=this.getVisitSchedules(),a=this.getProperties().find(c=>Number(c.id)===Number(e.casaId));if(!a)throw new Error("Propiedad no encontrada para crear horario");let o={id:Date.now(),vendedorId:e.vendedorId,casaId:e.casaId,fechaHoraInicio:e.fechaHoraInicio,fechaHoraFin:e.fechaHoraFin,espaciosDisponibles:e.espaciosDisponibles??1,vendedor:{id:e.vendedorId,nombre:"Usuario Actual"},casa:a,visitasAgendadas:[],fechaCreacion:new Date,fechaActualizacion:new Date};return t.push(o),this.saveVisitSchedules(t),o}updateVisitSchedule(e,t){let i=this.getVisitSchedules(),a=i.findIndex(o=>o.id===e);if(a!==-1){let o=r(s(s({},i[a]),t),{id:i[a].id,fechaActualizacion:new Date});return i[a]=o,this.saveVisitSchedules(i),o}throw new Error("Horario no encontrado")}deleteVisitSchedule(e){let i=this.getVisitSchedules().filter(a=>a.id!==e);this.saveVisitSchedules(i)}getVisits(){return this.getFromStorage(this.storageKeys.visits)||[]}saveVisits(e){this.saveToStorage(this.storageKeys.visits,e),this.visitsSubject.next(e)}addVisit(e){let t=this.getVisits(),i=r(s({},e),{id:Date.now(),fechaCreacion:new Date,status:"agendada"});return t.push(i),this.saveVisits(t),i}updateVisit(e,t){let i=this.getVisits(),a=i.findIndex(o=>o.id===e);if(a!==-1){let o=r(s(s({},i[a]),t),{id:i[a].id,fechaActualizacion:new Date});return i[a]=o,this.saveVisits(i),o}throw new Error("Visita no encontrada")}deleteVisit(e){let i=this.getVisits().filter(a=>a.id!==e);this.saveVisits(i)}getFromStorage(e){try{let t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch(t){return console.error(`Error reading from localStorage for key ${e}:`,t),[]}}saveToStorage(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(i){console.error(`Error saving to localStorage for key ${e}:`,i)}}initializeDefaultData(){if(this.getCategories().length===0){let e=[{id:1,nombre:"Casa",descripcion:"Casas residenciales familiares",activo:!0,fechaCreacion:new Date().toISOString()},{id:2,nombre:"Apartamento",descripcion:"Apartamentos urbanos modernos",activo:!0,fechaCreacion:new Date().toISOString()},{id:3,nombre:"Casa de lujo",descripcion:"Propiedades premium de alto valor",activo:!0,fechaCreacion:new Date().toISOString()},{id:4,nombre:"Finca",descripcion:"Propiedades rurales y fincas",activo:!0,fechaCreacion:new Date().toISOString()}];this.saveCategories(e)}if(this.getUbicaciones().length===0){let e=[{id:"1",ciudad:"Medell\xEDn",departamento:"Antioquia",descripcionCiudad:"Ciudad de la eterna primavera",descripcionDepartamento:"Departamento industrial y comercial",fechaCreacion:new Date,activo:!0},{id:"2",ciudad:"Bogot\xE1",departamento:"Cundinamarca",descripcionCiudad:"Capital de Colombia",descripcionDepartamento:"Departamento central administrativo",fechaCreacion:new Date,activo:!0},{id:"3",ciudad:"Cali",departamento:"Valle del Cauca",descripcionCiudad:"Capital del Valle del Cauca",descripcionDepartamento:"Departamento del suroccidente",fechaCreacion:new Date,activo:!0},{id:"4",ciudad:"Cartagena",departamento:"Bol\xEDvar",descripcionCiudad:"Ciudad hist\xF3rica y tur\xEDstica",descripcionDepartamento:"Departamento caribe\xF1o",fechaCreacion:new Date,activo:!0}];this.saveUbicaciones(e)}if(this.getUsuarios().length===0){let e=[{id:1,nombre:"Juan Carlos",apellido:"Vendedor",documento:"12345678",celular:"+573001234567",fechaNacimiento:"1985-05-15",correo:"juan.vendedor@hogar360.com",rol:"VENDEDOR",activo:!0,created_at:new Date().toISOString()},{id:2,nombre:"Mar\xEDa Isabel",apellido:"Compradora",documento:"87654321",celular:"+573007654321",fechaNacimiento:"1990-08-22",correo:"maria.compradora@hogar360.com",rol:"COMPRADOR",activo:!0,created_at:new Date().toISOString()}];this.saveUsuarios(e)}if(this.getProperties().length===0){let e=[{id:1,nombre:"Casa Laureles",descripcion:"Hermosa casa en el barrio Laureles con acabados de primera",categoria:{id:1,nombre:"Casa",descripcion:"Casas residenciales familiares"},cantidad_cuartos:3,cantidad_banos:2,precio:45e7,ubicacion:{id:1,ciudad:"Medell\xEDn",departamento:"Antioquia",descripcionCiudad:"Ciudad de la eterna primavera",descripcionDepartamento:"Departamento industrial y comercial"},fecha_publicacion_activa:new Date().toISOString(),estado_publicacion:"PUBLICADA",fecha_publicacion:new Date().toISOString(),vendedor:{id:1,nombre:"Juan Carlos Vendedor"},created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:2,nombre:"Apartamento Zona Rosa",descripcion:"Moderno apartamento en el coraz\xF3n de Bogot\xE1",categoria:{id:2,nombre:"Apartamento",descripcion:"Apartamentos urbanos modernos"},cantidad_cuartos:2,cantidad_banos:1,precio:32e7,ubicacion:{id:2,ciudad:"Bogot\xE1",departamento:"Cundinamarca",descripcionCiudad:"Capital de Colombia",descripcionDepartamento:"Departamento central administrativo"},fecha_publicacion_activa:new Date().toISOString(),estado_publicacion:"PUBLICADA",fecha_publicacion:new Date().toISOString(),vendedor:{id:1,nombre:"Juan Carlos Vendedor"},created_at:new Date().toISOString(),updated_at:new Date().toISOString()}];this.saveProperties(e)}}clearAllData(){Object.values(this.storageKeys).forEach(e=>{localStorage.removeItem(e)}),this.initializeDefaultData()}static \u0275fac=function(t){return new(t||d)};static \u0275prov=g({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})();export{b as a};

import{a as B,b as H}from"./chunk-AZWETWKG.js";import{b as O}from"./chunk-STP3WM4P.js";import{a as ve,b as Te,c as yt,d as pt,e as Ce,f as _e,g as De,h as be,i as ye,j as Nt,k as ht,l as Ne,m as Y,n as Me,o as $,p as xe,q as mt,r as Z,s as tt,t as J,u as ke,v as Le,w as Et,x as gt}from"./chunk-3KOIEGY5.js";import{a as Ie,d as Oe,e as X,g as Re}from"./chunk-BZNYC5N3.js";import{b as ft,c as Ae,d as Se}from"./chunk-XOLXN3IC.js";import{$ as ie,A as _t,Ac as ge,Db as le,Eb as fe,F as z,Fb as pe,G as F,Ga as ue,H as D,I as Dt,J as qt,L as K,M as Qt,Ma as de,Na as dt,O as te,P as ee,R as at,U as bt,Vb as he,X as oe,Z as re,_ as ne,a as T,b,ba as G,ca as ct,da as U,dc as me,ea as se,ec as Ee,ha as R,i as q,ic as Q,ka as y,l as Kt,ma as v,n as Xt,na as p,nb as lt,o as Yt,p as Zt,q as Jt,ra as ae,s as P,t as w,ta as ce,wa as ut,x as Wt,y as g}from"./chunk-PHL42RAN.js";var Ro={dispatch:!0,functional:!1,useEffectsErrorHandler:!0},At="__@ngrx/effects_create__";function et(t,r={}){let e=r.functional?t:t(),o=T(T({},Ro),r);return Object.defineProperty(e,At,{value:o}),e}function vo(t){return Object.getOwnPropertyNames(t).filter(o=>t[o]&&t[o].hasOwnProperty(At)?t[o][At].hasOwnProperty("dispatch"):!1).map(o=>{let n=t[o][At];return T({propertyName:o},n)})}function To(t){return vo(t)}function we(t){return Object.getPrototypeOf(t)}function Co(t){return!!t.constructor&&t.constructor.name!=="Object"&&t.constructor.name!=="Function"}function Fe(t){return typeof t=="function"}function _o(t){return t.filter(Fe)}function Do(t,r,e){let o=we(t),s=!!o&&o.constructor.name!=="Object"?o.constructor.name:null,u=To(t).map(({propertyName:c,dispatch:h,useEffectsErrorHandler:i})=>{let I=typeof t[c]=="function"?t[c]():t[c],a=i?e(I,r):I;return h===!1?a.pipe(Qt()):a.pipe(oe()).pipe(g(C=>({effect:t[c],notification:C,propertyName:c,sourceName:s,sourceInstance:t})))});return z(...u)}var bo=10;function Ue(t,r,e=bo){return t.pipe(D(o=>(r&&r.handleError(o),e<=1?t:Ue(t,r,e-1))))}var He=(()=>{class t extends q{constructor(e){super(),e&&(this.source=e)}lift(e){let o=new t;return o.source=this,o.operator=e,o}static{this.\u0275fac=function(o){return new(o||t)(v(ht))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function ot(...t){return F(r=>t.some(e=>typeof e=="string"?e===r.type:e.type===r.type))}var Or=new y("@ngrx/effects Internal Root Guard"),Rr=new y("@ngrx/effects User Provided Effects"),vr=new y("@ngrx/effects Internal Root Effects"),Tr=new y("@ngrx/effects Internal Root Effects Instances"),Cr=new y("@ngrx/effects Internal Feature Effects"),_r=new y("@ngrx/effects Internal Feature Effects Instance Groups"),yo=new y("@ngrx/effects Effects Error Handler",{providedIn:"root",factory:()=>Ue}),No="@ngrx/effects/init",Mo=Te(No);function xo(t,r){if(t.notification.kind==="N"){let e=t.notification.value;!ko(e)&&r.handleError(new Error(`Effect ${Lo(t)} dispatched an invalid action: ${wo(e)}`))}}function ko(t){return typeof t!="function"&&t&&t.type&&typeof t.type=="string"}function Lo({propertyName:t,sourceInstance:r,sourceName:e}){let o=typeof r[t]=="function";return!!e?`"${e}.${String(t)}${o?"()":""}"`:`"${String(t)}()"`}function wo(t){try{return JSON.stringify(t)}catch{return t}}var Fo="ngrxOnIdentifyEffects";function Uo(t){return Mt(t,Fo)}var Ho="ngrxOnRunEffects";function Po(t){return Mt(t,Ho)}var jo="ngrxOnInitEffects";function Go(t){return Mt(t,jo)}function Mt(t,r){return t&&r in t&&typeof t[r]=="function"}var Pe=(()=>{class t extends Kt{constructor(e,o){super(),this.errorHandler=e,this.effectsErrorHandler=o}addEffects(e){this.next(e)}toActions(){return this.pipe(bt(e=>Co(e)?we(e):e),_t(e=>e.pipe(bt($o))),_t(e=>{let o=e.pipe(at(s=>Bo(this.errorHandler,this.effectsErrorHandler)(s)),g(s=>(xo(s,this.errorHandler),s.notification)),F(s=>s.kind==="N"&&s.value!=null),ee()),n=e.pipe(K(1),F(Go),g(s=>s.ngrxOnInitEffects()));return z(o,n)}))}static{this.\u0275fac=function(o){return new(o||t)(v(dt),v(yo))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function $o(t){return Uo(t)?t.ngrxOnIdentifyEffects():""}function Bo(t,r){return e=>{let o=Do(e,t,r);return Po(e)?e.ngrxOnRunEffects(o):o}}var Vo=(()=>{class t{get isStarted(){return!!this.effectsSubscription}constructor(e,o){this.effectSources=e,this.store=o,this.effectsSubscription=null}start(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))}ngOnDestroy(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)}static{this.\u0275fac=function(o){return new(o||t)(v(Pe),v(Y))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function je(...t){let r=t.flat(),e=_o(r);return ut([e,{provide:ae,multi:!0,useValue:()=>{p(_e),p(De,{optional:!0});let o=p(Vo),n=p(Pe),s=!o.isStarted;s&&o.start();for(let u of r){let c=Fe(u)?p(u):u;n.addEffects(c)}s&&p(Y).dispatch(Mo())}}])}var nt="PERFORM_ACTION",zo="REFRESH",Ke="RESET",Xe="ROLLBACK",Ye="COMMIT",Ze="SWEEP",Je="TOGGLE_ACTION",Ko="SET_ACTIONS_ACTIVE",We="JUMP_TO_STATE",qe="JUMP_TO_ACTION",Vt="IMPORT_STATE",Qe="LOCK_CHANGES",to="PAUSE_RECORDING",W=class{constructor(r,e){if(this.action=r,this.timestamp=e,this.type=nt,typeof r.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?')}},xt=class{constructor(){this.type=zo}},kt=class{constructor(r){this.timestamp=r,this.type=Ke}},Lt=class{constructor(r){this.timestamp=r,this.type=Xe}},wt=class{constructor(r){this.timestamp=r,this.type=Ye}},Ft=class{constructor(){this.type=Ze}},Ut=class{constructor(r){this.id=r,this.type=Je}};var Ht=class{constructor(r){this.index=r,this.type=We}},Pt=class{constructor(r){this.actionId=r,this.type=qe}},jt=class{constructor(r){this.nextLiftedState=r,this.type=Vt}},Gt=class{constructor(r){this.status=r,this.type=Qe}},$t=class{constructor(r){this.status=r,this.type=to}};var Rt=new y("@ngrx/store-devtools Options"),Ge=new y("@ngrx/store-devtools Initial Config");function eo(){return null}var Xo="NgRx Store DevTools";function Yo(t){let r={maxAge:!1,monitor:eo,actionSanitizer:void 0,stateSanitizer:void 0,name:Xo,serialize:!1,logOnly:!1,autoPause:!1,trace:!1,traceLimit:75,features:{pause:!0,lock:!0,persist:!0,export:!0,import:"custom",jump:!0,skip:!0,reorder:!0,dispatch:!0,test:!0},connectInZone:!1},e=typeof t=="function"?t():t,o=e.logOnly?{pause:!0,export:!0,test:!0}:!1,n=e.features||o||r.features;n.import===!0&&(n.import="custom");let s=Object.assign({},r,{features:n},e);if(s.maxAge&&s.maxAge<2)throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${s.maxAge}`);return s}function $e(t,r){return t.filter(e=>r.indexOf(e)<0)}function oo(t){let{computedStates:r,currentStateIndex:e}=t;if(e>=r.length){let{state:n}=r[r.length-1];return n}let{state:o}=r[e];return o}function rt(t){return new W(t,+Date.now())}function Zo(t,r){return Object.keys(r).reduce((e,o)=>{let n=Number(o);return e[n]=ro(t,r[n],n),e},{})}function ro(t,r,e){return b(T({},r),{action:t(r.action,e)})}function Jo(t,r){return r.map((e,o)=>({state:no(t,e.state,o),error:e.error}))}function no(t,r,e){return t(r,e)}function io(t){return t.predicate||t.actionsSafelist||t.actionsBlocklist}function Wo(t,r,e,o){let n=[],s={},u=[];return t.stagedActionIds.forEach((c,h)=>{let i=t.actionsById[c];i&&(h&&zt(t.computedStates[h],i,r,e,o)||(s[c]=i,n.push(c),u.push(t.computedStates[h])))}),b(T({},t),{stagedActionIds:n,actionsById:s,computedStates:u})}function zt(t,r,e,o,n){let s=e&&!e(t,r.action),u=o&&!r.action.type.match(o.map(h=>Be(h)).join("|")),c=n&&r.action.type.match(n.map(h=>Be(h)).join("|"));return s||u||c}function Be(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function so(t){return{ngZone:t?p(de):null,connectInZone:t}}var vt=(()=>{class t extends pt{static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=ue(t)))(n||t)}})()}static{this.\u0275prov=R({token:t,factory:t.\u0275fac})}}return t})(),St={START:"START",DISPATCH:"DISPATCH",STOP:"STOP",ACTION:"ACTION"},Bt=new y("@ngrx/store-devtools Redux Devtools Extension"),ao=(()=>{class t{constructor(e,o,n){this.config=o,this.dispatcher=n,this.zoneConfig=so(this.config.connectInZone),this.devtoolsExtension=e,this.createActionStreams()}notify(e,o){if(this.devtoolsExtension)if(e.type===nt){if(o.isLocked||o.isPaused)return;let n=oo(o);if(io(this.config)&&zt(n,e,this.config.predicate,this.config.actionsSafelist,this.config.actionsBlocklist))return;let s=this.config.stateSanitizer?no(this.config.stateSanitizer,n,o.currentStateIndex):n,u=this.config.actionSanitizer?ro(this.config.actionSanitizer,e,o.nextActionId):e;this.sendToReduxDevtools(()=>this.extensionConnection.send(u,s))}else{let n=b(T({},o),{stagedActionIds:o.stagedActionIds,actionsById:this.config.actionSanitizer?Zo(this.config.actionSanitizer,o.actionsById):o.actionsById,computedStates:this.config.stateSanitizer?Jo(this.config.stateSanitizer,o.computedStates):o.computedStates});this.sendToReduxDevtools(()=>this.devtoolsExtension.send(null,n,this.getExtensionConfig(this.config)))}}createChangesObservable(){return this.devtoolsExtension?new q(e=>{let o=this.zoneConfig.connectInZone?this.zoneConfig.ngZone.runOutsideAngular(()=>this.devtoolsExtension.connect(this.getExtensionConfig(this.config))):this.devtoolsExtension.connect(this.getExtensionConfig(this.config));return this.extensionConnection=o,o.init(),o.subscribe(n=>e.next(n)),o.unsubscribe}):Zt}createActionStreams(){let e=this.createChangesObservable().pipe(ne()),o=e.pipe(F(i=>i.type===St.START)),n=e.pipe(F(i=>i.type===St.STOP)),s=e.pipe(F(i=>i.type===St.DISPATCH),g(i=>this.unwrapAction(i.payload)),Dt(i=>i.type===Vt?this.dispatcher.pipe(F(I=>I.type===Nt),Wt(1e3),qt(1e3),g(()=>i),D(()=>P(i)),K(1)):P(i))),c=e.pipe(F(i=>i.type===St.ACTION),g(i=>this.unwrapAction(i.payload))).pipe(ct(n)),h=s.pipe(ct(n));this.start$=o.pipe(ct(n)),this.actions$=this.start$.pipe(G(()=>c)),this.liftedActions$=this.start$.pipe(G(()=>h))}unwrapAction(e){return typeof e=="string"?(0,eval)(`(${e})`):e}getExtensionConfig(e){let o={name:e.name,features:e.features,serialize:e.serialize,autoPause:e.autoPause??!1,trace:e.trace??!1,traceLimit:e.traceLimit??75};return e.maxAge!==!1&&(o.maxAge=e.maxAge),o}sendToReduxDevtools(e){try{e()}catch(o){console.warn("@ngrx/store-devtools: something went wrong inside the redux devtools",o)}}static{this.\u0275fac=function(o){return new(o||t)(v(Bt),v(Rt),v(vt))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac})}}return t})(),Ot={type:yt},qo="@ngrx/store-devtools/recompute",Qo={type:qo};function co(t,r,e,o,n){if(o)return{state:e,error:"Interrupted by an error up the chain"};let s=e,u;try{s=t(e,r)}catch(c){u=c.toString(),n.handleError(c)}return{state:s,error:u}}function It(t,r,e,o,n,s,u,c,h){if(r>=t.length&&t.length===s.length)return t;let i=t.slice(0,r),I=s.length-(h?1:0);for(let a=r;a<I;a++){let f=s[a],C=n[f].action,l=i[a-1],d=l?l.state:o,x=l?l.error:void 0,k=u.indexOf(f)>-1?l:co(e,C,d,x,c);i.push(k)}return h&&i.push(t[t.length-1]),i}function tr(t,r){return{monitorState:r(void 0,{}),nextActionId:1,actionsById:{0:rt(Ot)},stagedActionIds:[0],skippedActionIds:[],committedState:t,currentStateIndex:0,computedStates:[],isLocked:!1,isPaused:!1}}function er(t,r,e,o,n={}){return s=>(u,c)=>{let{monitorState:h,actionsById:i,nextActionId:I,stagedActionIds:a,skippedActionIds:f,committedState:C,currentStateIndex:l,computedStates:d,isLocked:x,isPaused:_}=u||r;u||(i=Object.create(i));function k(S){let E=S,j=a.slice(1,E+1);for(let M=0;M<j.length;M++)if(d[M+1].error){E=M,j=a.slice(1,E+1);break}else delete i[j[M]];f=f.filter(M=>j.indexOf(M)===-1),a=[0,...a.slice(E+1)],C=d[E].state,d=d.slice(E),l=l>E?l-E:0}function L(){i={0:rt(Ot)},I=1,a=[0],f=[],C=d[l].state,l=0,d=[]}let m=0;switch(c.type){case Qe:{x=c.status,m=1/0;break}case to:{_=c.status,_?(a=[...a,I],i[I]=new W({type:"@ngrx/devtools/pause"},+Date.now()),I++,m=a.length-1,d=d.concat(d[d.length-1]),l===a.length-2&&l++,m=1/0):L();break}case Ke:{i={0:rt(Ot)},I=1,a=[0],f=[],C=t,l=0,d=[];break}case Ye:{L();break}case Xe:{i={0:rt(Ot)},I=1,a=[0],f=[],l=0,d=[];break}case Je:{let{id:S}=c;f.indexOf(S)===-1?f=[S,...f]:f=f.filter(j=>j!==S),m=a.indexOf(S);break}case Ko:{let{start:S,end:E,active:j}=c,M=[];for(let Ct=S;Ct<E;Ct++)M.push(Ct);j?f=$e(f,M):f=[...f,...M],m=a.indexOf(S);break}case We:{l=c.index,m=1/0;break}case qe:{let S=a.indexOf(c.actionId);S!==-1&&(l=S),m=1/0;break}case Ze:{a=$e(a,f),f=[],l=Math.min(l,a.length-1);break}case nt:{if(x)return u||r;if(_||u&&zt(u.computedStates[l],c,n.predicate,n.actionsSafelist,n.actionsBlocklist)){let E=d[d.length-1];d=[...d.slice(0,-1),co(s,c.action,E.state,E.error,e)],m=1/0;break}n.maxAge&&a.length===n.maxAge&&k(1),l===a.length-1&&l++;let S=I++;i[S]=c,a=[...a,S],m=a.length-1;break}case Vt:{({monitorState:h,actionsById:i,nextActionId:I,stagedActionIds:a,skippedActionIds:f,committedState:C,currentStateIndex:l,computedStates:d,isLocked:x,isPaused:_}=c.nextLiftedState);break}case yt:{m=0,n.maxAge&&a.length>n.maxAge&&(d=It(d,m,s,C,i,a,f,e,_),k(a.length-n.maxAge),m=1/0);break}case Nt:{if(d.filter(E=>E.error).length>0)m=0,n.maxAge&&a.length>n.maxAge&&(d=It(d,m,s,C,i,a,f,e,_),k(a.length-n.maxAge),m=1/0);else{if(!_&&!x){l===a.length-1&&l++;let E=I++;i[E]=new W(c,+Date.now()),a=[...a,E],m=a.length-1,d=It(d,m,s,C,i,a,f,e,_)}d=d.map(E=>b(T({},E),{state:s(E.state,Qo)})),l=a.length-1,n.maxAge&&a.length>n.maxAge&&k(a.length-n.maxAge),m=1/0}break}default:{m=1/0;break}}return d=It(d,m,s,C,i,a,f,e,_),h=o(h,c),{monitorState:h,actionsById:i,nextActionId:I,stagedActionIds:a,skippedActionIds:f,committedState:C,currentStateIndex:l,computedStates:d,isLocked:x,isPaused:_}}}var Ve=(()=>{class t{constructor(e,o,n,s,u,c,h,i){let I=tr(h,i.monitor),a=er(h,I,c,i.monitor,i),f=z(z(o.asObservable().pipe(ie(1)),s.actions$).pipe(g(rt)),e,s.liftedActions$).pipe(Jt(Yt)),C=n.pipe(g(a)),l=so(i.connectInZone),d=new Xt(1);this.liftedStateSubscription=f.pipe(se(C),ze(l),re(({state:k},[L,m])=>{let S=m(k,L);return L.type!==nt&&io(i)&&(S=Wo(S,i.predicate,i.actionsSafelist,i.actionsBlocklist)),s.notify(L,S),{state:S,action:L}},{state:I,action:null})).subscribe(({state:k,action:L})=>{if(d.next(k),L.type===nt){let m=L.action;u.next(m)}}),this.extensionStartSubscription=s.start$.pipe(ze(l)).subscribe(()=>{this.refresh()});let x=d.asObservable(),_=x.pipe(g(oo));Object.defineProperty(_,"state",{value:ve(_,{manualCleanup:!0,requireSync:!0})}),this.dispatcher=e,this.liftedState=x,this.state=_}ngOnDestroy(){this.liftedStateSubscription.unsubscribe(),this.extensionStartSubscription.unsubscribe()}dispatch(e){this.dispatcher.next(e)}next(e){this.dispatcher.next(e)}error(e){}complete(){}performAction(e){this.dispatch(new W(e,+Date.now()))}refresh(){this.dispatch(new xt)}reset(){this.dispatch(new kt(+Date.now()))}rollback(){this.dispatch(new Lt(+Date.now()))}commit(){this.dispatch(new wt(+Date.now()))}sweep(){this.dispatch(new Ft)}toggleAction(e){this.dispatch(new Ut(e))}jumpToAction(e){this.dispatch(new Pt(e))}jumpToState(e){this.dispatch(new Ht(e))}importState(e){this.dispatch(new jt(e))}lockChanges(e){this.dispatch(new Gt(e))}pauseRecording(e){this.dispatch(new $t(e))}static{this.\u0275fac=function(o){return new(o||t)(v(vt),v(pt),v(be),v(ao),v(ht),v(dt),v(Ce),v(Rt))}}static{this.\u0275prov=R({token:t,factory:t.\u0275fac})}}return t})();function ze({ngZone:t,connectInZone:r}){return e=>r?new q(o=>e.subscribe({next:n=>t.run(()=>o.next(n)),error:n=>t.run(()=>o.error(n)),complete:()=>t.run(()=>o.complete())})):e}var or=new y("@ngrx/store-devtools Is Devtools Extension or Monitor Present");function rr(t,r){return!!t||r.monitor!==eo}function nr(){let t="__REDUX_DEVTOOLS_EXTENSION__";return typeof window=="object"&&typeof window[t]<"u"?window[t]:null}function uo(t={}){return ut([ao,vt,Ve,{provide:Ge,useValue:t},{provide:or,deps:[Bt,Rt],useFactory:rr},{provide:Bt,useFactory:nr},{provide:Rt,deps:[Ge],useFactory:Yo},{provide:Ne,deps:[Ve],useFactory:ir},{provide:ye,useExisting:vt}])}function ir(t){return t.state}var N={HOME:"/",LOGIN:"/login",REGISTER:"/register",LANDING:"/landing",PROPERTIES:"/propiedades",PROPERTY_DETAIL:"/propiedades/:id",VISIT_SCHEDULES:"/horarios-disponibles",DASHBOARD:"/dashboard",ADMIN_DASHBOARD:"/admin/dashboard",ADMIN_CATEGORIES:"/admin/categorias",ADMIN_LOCATIONS:"/admin/ubicaciones",ADMIN_USERS:"/admin/usuarios-vendedores",ADMIN_PROPERTIES:"/admin/propiedades",ADMIN_SETTINGS:"/admin/configuracion",SELLER_DASHBOARD:"/vendedor/dashboard",SELLER_PROPERTIES:"/vendedor/propiedades",SELLER_SCHEDULES:"/vendedor/horarios-visitas",BUYER_DASHBOARD:"/comprador/dashboard",BUYER_VISITS:"/comprador/visitas",BUYER_SCHEDULE_VISIT:"/comprador/agendar-visita"},A={ACCESS_TOKEN:"access_token",REFRESH_TOKEN:"refresh_token",USER:"user",THEME:"theme",LANGUAGE:"language"};var it={SUCCESS:{LOGIN:"Inicio de sesi\xF3n exitoso",LOGOUT:"Sesi\xF3n cerrada exitosamente",CREATED:"Creado exitosamente",UPDATED:"Actualizado exitosamente",DELETED:"Eliminado exitosamente"},ERROR:{GENERIC:"Ha ocurrido un error inesperado",NETWORK:"Error de conexi\xF3n",UNAUTHORIZED:"No autorizado",FORBIDDEN:"Acceso denegado",NOT_FOUND:"Recurso no encontrado",VALIDATION:"Datos inv\xE1lidos"},CONFIRMATION:{DELETE:"\xBFEst\xE1 seguro de que desea eliminar este elemento?",LOGOUT:"\xBFEst\xE1 seguro de que desea cerrar sesi\xF3n?"}};var st=(()=>{class t{authFacade=p(gt);router=p(X);canActivate(e,o){return this.checkAuthStatus(e,o)}canActivateChild(e,o){return this.checkAuthStatus(e,o)}checkAuthStatus(e,o){return console.log("\u{1F512} AuthGuard: Checking auth status for route:",o.url),this.authFacade.isAuthenticated$.pipe(K(1),g(n=>{if(console.log("\u{1F512} AuthGuard: Is authenticated:",n),!n)return console.log("\u{1F512} AuthGuard: User not authenticated, redirecting to login"),this.router.navigate([N.LOGIN],{queryParams:{returnUrl:o.url}}),!1;let s=e.data?.role,u=this.authFacade.getUserRole();return console.log("\u{1F512} AuthGuard: Required role:",s),console.log("\u{1F512} AuthGuard: User role:",u),s&&u!==s?(console.log("\u{1F512} AuthGuard: Role mismatch, redirecting to appropriate dashboard"),this.redirectToAppropriateRoute(u),!1):(console.log("\u{1F512} AuthGuard: Access granted"),!0)}))}redirectToAppropriateRoute(e){switch(e){case O.ADMIN:this.router.navigate([N.ADMIN_DASHBOARD]);break;case O.VENDEDOR:this.router.navigate([N.SELLER_DASHBOARD]);break;case O.COMPRADOR:this.router.navigate([N.BUYER_DASHBOARD]);break;default:this.router.navigate([N.LOGIN])}}static \u0275fac=function(o){return new(o||t)};static \u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var lo=[{path:"",redirectTo:"/landing",pathMatch:"full"},{path:"landing",loadComponent:()=>import("./chunk-LFTUNHOE.js").then(t=>t.LandingComponent),title:"Hogar360 - Encuentra tu casa perfecta"},{path:"login",loadComponent:()=>import("./chunk-KZMFE3WB.js").then(t=>t.LoginComponent),title:"Iniciar Sesi\xF3n - Hogar360"},{path:"",loadComponent:()=>import("./chunk-6Y46DOB5.js").then(t=>t.PublicLayoutComponent),children:[{path:"propiedades",loadComponent:()=>import("./chunk-SPQ25AZM.js").then(t=>t.PropertyListingComponent),title:"Propiedades Disponibles - Hogar360"},{path:"horarios-disponibles",loadComponent:()=>import("./chunk-2YIFRFKW.js").then(t=>t.VisitSchedulesListingComponent),title:"Horarios de Visitas Disponibles - Hogar360"}]},{path:"dashboard",canActivate:[st],loadComponent:()=>import("./chunk-DS7NITOL.js").then(t=>t.DashboardRedirectComponent),title:"Redirigiendo... - Hogar360"},{path:"admin",canActivate:[st],data:{role:O.ADMIN},loadComponent:()=>import("./chunk-6WAISE5T.js").then(t=>t.UnifiedLayoutComponent),children:[{path:"dashboard",loadComponent:()=>import("./chunk-6LVIS2HN.js").then(t=>t.DashboardContentComponent),title:"Dashboard Admin - Hogar360"},{path:"categorias",loadComponent:()=>import("./chunk-HB4LOQ2L.js").then(t=>t.CategoriasComponent),title:"Gesti\xF3n de Categor\xEDas - Hogar360"},{path:"ubicaciones",loadComponent:()=>import("./chunk-UDURFBAP.js").then(t=>t.UbicacionesComponent),title:"Gesti\xF3n de Ubicaciones - Hogar360"},{path:"usuarios-vendedores",loadComponent:()=>import("./chunk-C6CX2ITC.js").then(t=>t.UsuariosVendedoresComponent),title:"Gesti\xF3n de Usuarios Vendedores - Hogar360"},{path:"propiedades",loadComponent:()=>import("./chunk-O7B45K4F.js").then(t=>t.PropertiesComponent),title:"Gesti\xF3n de Propiedades - Hogar360"},{path:"horarios-visitas",loadComponent:()=>import("./chunk-2YIFRFKW.js").then(t=>t.VisitSchedulesListingComponent),title:"Horarios de Visitas - Hogar360"},{path:"configuracion",loadComponent:()=>import("./chunk-2FFOCSN3.js").then(t=>t.SettingsComponent),title:"Configuraci\xF3n - Hogar360"},{path:"",redirectTo:"dashboard",pathMatch:"full"}]},{path:"vendedor",canActivate:[st],data:{role:O.VENDEDOR},loadComponent:()=>import("./chunk-6WAISE5T.js").then(t=>t.UnifiedLayoutComponent),children:[{path:"dashboard",loadComponent:()=>import("./chunk-6LVIS2HN.js").then(t=>t.DashboardContentComponent),title:"Dashboard Vendedor - Hogar360"},{path:"categorias",loadComponent:()=>import("./chunk-HB4LOQ2L.js").then(t=>t.CategoriasComponent),title:"Categor\xEDas de Inmuebles - Hogar360"},{path:"ubicaciones",loadComponent:()=>import("./chunk-UDURFBAP.js").then(t=>t.UbicacionesComponent),title:"Ubicaciones Disponibles - Hogar360"},{path:"propiedades",loadComponent:()=>import("./chunk-O7B45K4F.js").then(t=>t.PropertiesComponent),title:"Mis Propiedades - Hogar360"},{path:"horarios-visitas",loadComponent:()=>import("./chunk-WCXYH74T.js").then(t=>t.VisitSchedulesComponent),title:"Horarios de Visitas - Hogar360"},{path:"configuracion",loadComponent:()=>import("./chunk-2FFOCSN3.js").then(t=>t.SettingsComponent),title:"Configuraci\xF3n - Hogar360"},{path:"",redirectTo:"dashboard",pathMatch:"full"}]},{path:"comprador",canActivate:[st],data:{role:O.COMPRADOR},loadComponent:()=>import("./chunk-6WAISE5T.js").then(t=>t.UnifiedLayoutComponent),children:[{path:"dashboard",loadComponent:()=>import("./chunk-6LVIS2HN.js").then(t=>t.DashboardContentComponent),title:"Dashboard Comprador - Hogar360"},{path:"categorias",loadComponent:()=>import("./chunk-HB4LOQ2L.js").then(t=>t.CategoriasComponent),title:"Categor\xEDas de Inmuebles - Hogar360"},{path:"ubicaciones",loadComponent:()=>import("./chunk-UDURFBAP.js").then(t=>t.UbicacionesComponent),title:"Ubicaciones Disponibles - Hogar360"},{path:"visitas",loadComponent:()=>import("./chunk-PTSTMV77.js").then(t=>t.VisitsComponent),title:"Mis Visitas Agendadas - Hogar360"},{path:"horarios-visitas",loadComponent:()=>import("./chunk-2YIFRFKW.js").then(t=>t.VisitSchedulesListingComponent),title:"Horarios de Visitas - Hogar360"},{path:"agendar-visita",loadComponent:()=>import("./chunk-JTDKRB5P.js").then(t=>t.ScheduleVisitComponent),title:"Agendar Visita - Hogar360"},{path:"",redirectTo:"dashboard",pathMatch:"full"}]},{path:"**",redirectTo:"/login"}];var Tt=(()=>{class t{mockUsers=[{id:1,nombre:"Admin",apellido:"Hogar360",correo:"admin@hogar360.com",role:O.ADMIN,documento_identidad:"12345678",celular:"+573001234567",fecha_nacimiento:new Date("1985-01-01"),created_at:new Date},{id:2,nombre:"Juan",apellido:"Vendedor",correo:"vendedor@hogar360.com",role:O.VENDEDOR,documento_identidad:"87654321",celular:"+573007654321",fecha_nacimiento:new Date("1990-05-15"),created_at:new Date},{id:3,nombre:"Mar\xEDa",apellido:"Compradora",correo:"comprador@hogar360.com",role:O.COMPRADOR,documento_identidad:"11223344",celular:"+573009876543",fecha_nacimiento:new Date("1988-12-10"),created_at:new Date}];login(e){let{correo:o,clave:n}=e;return P(null).pipe(te(800),G(()=>{let u=[{email:"admin@hogar360.com",password:"admin123",userId:1},{email:"vendedor@hogar360.com",password:"vendedor123",userId:2},{email:"comprador@hogar360.com",password:"comprador123",userId:3}].find(i=>i.email===o&&i.password===n);if(!u)return w(()=>({error:"Credenciales inv\xE1lidas",status:401}));let c=this.mockUsers.find(i=>i.id===u.userId),h={user:c,access_token:`mock-jwt-token-${c.id}-${Date.now()}`,refresh_token:`mock-refresh-token-${c.id}-${Date.now()}`,expires_in:3600};return P(h)}))}static \u0275fac=function(o){return new(o||t)};static \u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var sr=!0,fo=(()=>{class t{http=p(ft);router=p(X);mockAuthService=p(Tt);_currentUser=lt(null);_isAuthenticated=lt(!1);_isLoading=lt(!1);currentUser=this._currentUser.asReadonly();isAuthenticated=this._isAuthenticated.asReadonly();isLoading=this._isLoading.asReadonly();userRole=Q(()=>this._currentUser()?.role||null);isAdmin=Q(()=>this.userRole()===O.ADMIN);isVendedor=Q(()=>this.userRole()===O.VENDEDOR);isComprador=Q(()=>this.userRole()===O.COMPRADOR);constructor(){this.initializeAuth()}initializeAuth(){console.log("\u{1F527} AuthService: Initializing auth state");let e=this.getStoredToken(),o=this.getStoredUser();console.log("\u{1F527} AuthService: Stored token exists:",!!e),console.log("\u{1F527} AuthService: Stored user exists:",!!o),e&&o?(console.log("\u{1F527} AuthService: Setting user as authenticated:",o),this._currentUser.set(o),this._isAuthenticated.set(!0)):console.log("\u{1F527} AuthService: No valid auth data found")}login(e){return console.log("\u{1F510} AuthService: Login attempt for:",e.correo),this._isLoading.set(!0),sr?this.mockAuthService.login(e).pipe(U(o=>{this.setAuthData(o),this.navigateAfterLogin(o.user.role)}),D(this.handleError.bind(this)),U(()=>this._isLoading.set(!1))):this.http.post(`${B.BASE_URL}${H.LOGIN}`,e).pipe(g(o=>o.data),U(o=>{this.setAuthData(o),this.navigateAfterLogin(o.user.role)}),D(this.handleError.bind(this)),U(()=>this._isLoading.set(!1)))}logout(){this._isLoading.set(!0),this.getStoredToken()?this.http.post(`${B.BASE_URL}${H.LOGOUT}`,{}).subscribe({complete:()=>this.clearAuthData()}):this.clearAuthData()}refreshToken(){let e=this.getStoredRefreshToken();return e?this.http.post(`${B.BASE_URL}${H.REFRESH}`,{refresh_token:e}).pipe(g(o=>o.data),U(o=>{this.setAuthData(o)}),D(o=>(this.clearAuthData(),w(()=>o)))):w(()=>new Error("No refresh token available"))}getCurrentUser(){return this.http.get(`${B.BASE_URL}${H.USER_PROFILE}`).pipe(g(e=>e.data),U(e=>this._currentUser.set(e)),D(this.handleError.bind(this)))}setAuthData(e){console.log("\u{1F4BE} AuthService: Setting auth data for user:",e.user),localStorage.setItem(A.ACCESS_TOKEN,e.access_token),localStorage.setItem(A.REFRESH_TOKEN,e.refresh_token),localStorage.setItem(A.USER,JSON.stringify(e.user)),this._currentUser.set(e.user),this._isAuthenticated.set(!0),console.log("\u{1F4BE} AuthService: Auth data set successfully"),console.log("\u{1F4BE} AuthService: Current user signal:",this._currentUser()),console.log("\u{1F4BE} AuthService: Is authenticated signal:",this._isAuthenticated())}clearAuthData(){localStorage.removeItem(A.ACCESS_TOKEN),localStorage.removeItem(A.REFRESH_TOKEN),localStorage.removeItem(A.USER),this._currentUser.set(null),this._isAuthenticated.set(!1),this._isLoading.set(!1),this.router.navigate([N.LOGIN])}navigateAfterLogin(e){console.log("\u{1F680} AuthService: Navigating after login for role:",e),setTimeout(()=>{switch(e){case O.ADMIN:console.log("\u{1F680} AuthService: Redirecting to admin dashboard"),this.router.navigate([N.ADMIN_DASHBOARD]);break;case O.VENDEDOR:console.log("\u{1F680} AuthService: Redirecting to vendor dashboard"),this.router.navigate([N.SELLER_DASHBOARD]);break;case O.COMPRADOR:console.log("\u{1F680} AuthService: Redirecting to buyer dashboard"),this.router.navigate([N.BUYER_DASHBOARD]);break;default:console.log("\u{1F680} AuthService: Redirecting to default dashboard"),this.router.navigate([N.DASHBOARD])}},100)}getStoredToken(){return localStorage.getItem(A.ACCESS_TOKEN)}getStoredRefreshToken(){return localStorage.getItem(A.REFRESH_TOKEN)}getStoredUser(){let e=localStorage.getItem(A.USER);return e?JSON.parse(e):null}handleError(e){let o=it.ERROR.GENERIC;return e.status===401?(o=it.ERROR.UNAUTHORIZED,this.clearAuthData()):e.status===403?o=it.ERROR.FORBIDDEN:e.status===0?o=it.ERROR.NETWORK:e.error?.message&&(o=e.error.message),w(()=>new Error(o))}static \u0275fac=function(o){return new(o||t)};static \u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var po=(()=>{class t{authService=p(fo);intercept(e,o){if(e.url.includes(H.LOGIN)||e.url.includes(H.REFRESH))return o.handle(e);let s=this.authService.getStoredToken();return s&&(e=this.addAuthHeader(e,s)),o.handle(e).pipe(D(u=>u.status===401&&s?this.handle401Error(e,o):w(()=>u)))}addAuthHeader(e,o){return e.clone({setHeaders:{Authorization:`Bearer ${o}`}})}handle401Error(e,o){return this.authService.refreshToken().pipe(G(()=>{let n=this.authService.getStoredToken();return n?o.handle(this.addAuthHeader(e,n)):w(()=>new Error("No token available"))}),D(n=>(this.authService.logout(),w(()=>n))))}static \u0275fac=function(o){return new(o||t)};static \u0275prov=R({token:t,factory:t.\u0275fac})}return t})();var ho={user:null,isAuthenticated:!1,isLoading:!1,error:null};var mo=xe(ho,$(mt,t=>b(T({},t),{isLoading:!0,error:null})),$(Z,(t,{user:r})=>b(T({},t),{user:r,isAuthenticated:!0,isLoading:!1,error:null})),$(tt,(t,{error:r})=>b(T({},t),{user:null,isAuthenticated:!1,isLoading:!1,error:r})),$(J,t=>b(T({},t),{user:null,isAuthenticated:!1,isLoading:!1,error:null})),$(ke,t=>b(T({},t),{error:null})),$(Et,(t,{user:r})=>b(T({},t),{user:r,isAuthenticated:!0,isLoading:!1,error:null})));var cr=!0,Eo=(()=>{class t{actions$=p(He);http=p(ft);mockAuthService=p(Tt);router=p(X);store=p(Y);login$=et(()=>this.actions$.pipe(ot(mt),at(e=>cr?this.mockAuthService.login(e.credentials).pipe(g(o=>(localStorage.setItem(A.ACCESS_TOKEN,o.access_token),localStorage.setItem(A.REFRESH_TOKEN,o.refresh_token),localStorage.setItem(A.USER,JSON.stringify(o.user)),Z({user:o.user,accessToken:o.access_token,refreshToken:o.refresh_token}))),D(o=>P(tt({error:o.message||"Login failed"})))):this.http.post(`${B.BASE_URL}${H.LOGIN}`,e.credentials).pipe(g(o=>o.data),g(o=>(localStorage.setItem(A.ACCESS_TOKEN,o.access_token),localStorage.setItem(A.REFRESH_TOKEN,o.refresh_token),localStorage.setItem(A.USER,JSON.stringify(o.user)),Z({user:o.user,accessToken:o.access_token,refreshToken:o.refresh_token}))),D(o=>P(tt({error:o.message||"Login failed"})))))));loginSuccess$=et(()=>this.actions$.pipe(ot(Z),U(({user:e})=>{this.navigateBasedOnRole(e.role)})),{dispatch:!1});logout$=et(()=>this.actions$.pipe(ot(J),U(()=>{localStorage.removeItem(A.ACCESS_TOKEN),localStorage.removeItem(A.REFRESH_TOKEN),localStorage.removeItem(A.USER),this.router.navigate(["/login"])})),{dispatch:!1});initializeAuth$=et(()=>this.actions$.pipe(ot(Le),g(()=>{let e=localStorage.getItem(A.ACCESS_TOKEN),o=localStorage.getItem(A.USER);if(e&&o)try{let n=JSON.parse(o);return Et({user:n})}catch(n){return console.error("Error parsing stored user:",n),J()}return J()})));navigateBasedOnRole(e){switch(e){case"admin":this.router.navigate(["/admin/dashboard"]);break;case"vendedor":this.router.navigate(["/vendedor/dashboard"]);break;case"comprador":this.router.navigate(["/comprador/dashboard"]);break;default:this.router.navigate(["/login"]);break}}static \u0275fac=function(o){return new(o||t)};static \u0275prov=R({token:t,factory:t.\u0275fac})}return t})();var go={providers:[me({eventCoalescing:!0}),Re(lo),Se(),{provide:Ae,useClass:po,multi:!0},Me({auth:mo}),je([Eo]),uo({maxAge:25,logOnly:!Ee(),autoPause:!0,trace:!1,traceLimit:75})]};var Ao=(()=>{class t{authFacade=p(gt);ngOnInit(){this.authFacade.initializeAuth()}title="Hogar360";static \u0275fac=function(o){return new(o||t)};static \u0275cmp=ce({type:t,selectors:[["app-root"]],standalone:!0,features:[he],decls:2,vars:0,consts:[[1,"app-container"]],template:function(o,n){o&1&&(le(0,"div",0),pe(1,"router-outlet"),fe())},dependencies:[ge,Oe],styles:[".app-container[_ngcontent-%COMP%]{min-height:100vh;--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}"]})}return t})();Ie(Ao,go).catch(t=>console.error(t));

import{a as S}from"./chunk-OATTNESZ.js";import{O as o,ha as f,na as P,nb as d,s as i,y as a}from"./chunk-PHL42RAN.js";var x=(()=>{class n{localStorageService=P(S);properties=d([]);loading=d(!1);error=d(null);createProperty(e){this.loading.set(!0),this.error.set(null);try{let t=this.localStorageService.addProperty(e);return this.loading.set(!1),this.properties.set(this.localStorageService.getProperties()),i(t).pipe(o(300))}catch(t){return this.setError("Error al crear la propiedad"),i().pipe(o(300),a(()=>{throw t}))}}getProperties(e={}){return this.loading.set(!0),this.error.set(null),i(null).pipe(o(300),a(()=>{let t=this.localStorageService.getProperties();e.ubicacion_id&&(t=t.filter(r=>r.ubicacion_id===e.ubicacion_id)),e.categoria_id&&(t=t.filter(r=>r.categoria_id===e.categoria_id)),e.cantidad_cuartos&&(t=t.filter(r=>r.cantidad_cuartos>=e.cantidad_cuartos)),e.cantidad_banos&&(t=t.filter(r=>r.cantidad_banos>=e.cantidad_banos)),e.precio_minimo&&(t=t.filter(r=>r.precio>=e.precio_minimo)),e.precio_maximo&&(t=t.filter(r=>r.precio<=e.precio_maximo)),e.sortBy&&(t=t.sort((r,m)=>{let h=e.sortBy,c=r[h],p=m[h];return e.sortOrder==="desc"?c>p?-1:c<p?1:0:c>p?1:c<p?-1:0}));let s=e.page||1,l=e.limit||10,g=(s-1)*l,y=g+l,u=t.slice(g,y);return this.loading.set(!1),this.properties.set(u),{data:u,total:t.length,page:s,limit:l,totalPages:Math.ceil(t.length/l)}}))}getPropertyById(e){return this.loading.set(!0),this.error.set(null),i(null).pipe(o(200),a(()=>{let t=this.localStorageService.getPropertyById(e);if(this.loading.set(!1),!t)throw this.setError("Propiedad no encontrada"),new Error("Propiedad no encontrada");return t}))}updateProperty(e,t){return this.loading.set(!0),this.error.set(null),i(null).pipe(o(300),a(()=>{let s=this.localStorageService.updateProperty(e,t);return this.loading.set(!1),this.properties.set(this.localStorageService.getProperties()),s}))}deleteProperty(e){return this.loading.set(!0),this.error.set(null),i(null).pipe(o(300),a(()=>{this.localStorageService.deleteProperty(e),this.loading.set(!1),this.properties.set(this.localStorageService.getProperties())}))}getPropertiesByVendedor(e){return this.loading.set(!0),this.error.set(null),i(null).pipe(o(200),a(()=>{let t=this.localStorageService.getProperties().filter(s=>s.vendedor_id===e);return this.loading.set(!1),t}))}getMyProperties(){return i(null).pipe(o(200),a(()=>{let e=this.localStorageService.getProperties();return this.loading.set(!1),e}))}setProperties(e){this.properties.set(e)}setError(e){this.error.set(e),this.loading.set(!1)}clearLoading(){this.loading.set(!1)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=f({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();export{x as a};

import{a as U}from"./chunk-OATTNESZ.js";import{O as p,ha as f,i as n,na as x,nb as u,s as d}from"./chunk-PHL42RAN.js";var I=(()=>{class o{localStorageService=x(U);ubicaciones=u([]);loading=u(!1);constructor(){this.ubicaciones.set(this.localStorageService.getUbicaciones()),this.localStorageService.ubicaciones$.subscribe(e=>{this.ubicaciones.set(e)})}createUbicacion(e){return new n(t=>{setTimeout(()=>{let c=this.validateUbicacion(e);if(c.length>0){t.next({success:!1,message:c.join(", ")}),t.complete();return}if(this.isDepartamentoExists(e.departamento)){t.next({success:!1,message:"El departamento ya existe"}),t.complete();return}let i=this.localStorageService.addUbicacion(e);t.next({success:!0,message:"Ubicaci\xF3n creada exitosamente",ubicacion:i}),t.complete()},500)})}getUbicaciones(){return d(this.localStorageService.getUbicaciones()).pipe(p(300))}searchUbicaciones(e={}){return new n(t=>{setTimeout(()=>{let i=this.localStorageService.getUbicaciones();if(e.texto){let a=e.texto.toLowerCase();i=i.filter(s=>s.ciudad.toLowerCase().includes(a)||s.departamento.toLowerCase().includes(a)||s.descripcionCiudad.toLowerCase().includes(a)||s.descripcionDepartamento.toLowerCase().includes(a))}e.ordenarPor&&i.sort((a,s)=>{let g=a[e.ordenarPor],h=s[e.ordenarPor];return e.ordenAscendente===!1?h.localeCompare(g):g.localeCompare(h)});let r=e.page||1,l=e.pageSize||10,m=(r-1)*l,S=m+l,L=i.slice(m,S);t.next({ubicaciones:L,total:i.length,page:r,pageSize:l,totalPages:Math.ceil(i.length/l)}),t.complete()},300)})}getUbicacionById(e){return d(this.localStorageService.getUbicacionById(e)).pipe(p(200))}updateUbicacion(e,t){return new n(c=>{setTimeout(()=>{let i=this.validateUbicacion(t);if(i.length>0){c.next({success:!1,message:i.join(", ")}),c.complete();return}if(this.isDepartamentoExists(t.departamento,e)){c.next({success:!1,message:"El departamento ya existe"}),c.complete();return}let r=this.localStorageService.updateUbicacion(e,t);c.next({success:!0,message:"Ubicaci\xF3n actualizada exitosamente",ubicacion:r}),c.complete()},500)})}deleteUbicacion(e){return new n(t=>{setTimeout(()=>{try{this.localStorageService.deleteUbicacion(e),t.next({success:!0,message:"Ubicaci\xF3n eliminada exitosamente"}),t.complete()}catch{t.next({success:!1,message:"Error al eliminar la ubicaci\xF3n"}),t.complete()}},500)})}isDepartamentoExists(e,t){return this.localStorageService.getUbicaciones().some(i=>i.departamento.toLowerCase()===e.toLowerCase()&&(!t||i.id!==t))}validateUbicacion(e){let t=[];return!e.ciudad||e.ciudad.trim().length===0?t.push("La ciudad es requerida"):e.ciudad.length>50&&t.push("La ciudad no puede exceder 50 caracteres"),!e.departamento||e.departamento.trim().length===0?t.push("El departamento es requerido"):e.departamento.length>50&&t.push("El departamento no puede exceder 50 caracteres"),!e.descripcionCiudad||e.descripcionCiudad.trim().length===0?t.push("La descripci\xF3n de la ciudad es requerida"):e.descripcionCiudad.length>200&&t.push("La descripci\xF3n de la ciudad no puede exceder 200 caracteres"),!e.descripcionDepartamento||e.descripcionDepartamento.trim().length===0?t.push("La descripci\xF3n del departamento es requerida"):e.descripcionDepartamento.length>200&&t.push("La descripci\xF3n del departamento no puede exceder 200 caracteres"),t}static \u0275fac=function(t){return new(t||o)};static \u0275prov=f({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();export{I as a};
